---
title: "Example code for calculating PDD and FUV of LAPS sensitivity runs"
author: Johanna LK Wren and Taylor Ely
date: June 29, 2021
output:
  html_notebook:
    theme: flatly
    toc: true
    toc_float:
      collapsed: false
      tod_depth: 3
---

# Description
### This code takes a trajectory file generated by OceanParcels, calculates particle density distributions (PDD), and calculated FUVs between 2 PDDs

```{r}
#load libraries
library(ncdf4)
library(dplyr)
library(MASS)
```

# Read in trajectory file
### The OceanParcls output file consists of lat, lon, and age (and others) for each particle. One column is one particle, the number of rows is number of time steps. 

```{r}
# Create function to read in trajectory file at a particular day
load_netcdf<-function(datafile, subsetday){
  dat <- nc_open(datafile)
  lo <- ncvar_get(dat, 'lon')
  la <- ncvar_get(dat, 'lat')
  a <- ncvar_get(dat, 'age')
  site<-ncvar_get(dat, 'releaseSite')
  nc_close(dat)
  idx <- which(a == subsetday*86400)
  output <<- bind_cols(lon=lo[idx], lat=la[idx], site=site[idx]) 
}

#load n100 with diff days
n100_day30<-load_netcdf('n100_day30.nc',30)
n100_day60<-load_netcdf('n100_day60.nc',60)
n100_day90<-load_netcdf('n100_day90.nc',90)
n100_day180<-load_netcdf('n100_day180.nc',180)

#load n100 2nd run with diff days
n100_repeat_day30<-load_netcdf('n100_repeat_day30.nc',30)
n100_repeat_day60<-load_netcdf('n100_repeat_day60.nc',60)
n100_repeat_day90<-load_netcdf('n100_repeat_day90.nc',90)
n100_repeat_day180<-load_netcdf('n100_repeat_day180.nc',180)

#load n250 with diff days
n250_day30<-load_netcdf('n250_day30.nc',30)
n250_day60<-load_netcdf('n250_day60.nc',60)
n250_day90<-load_netcdf('n250_day90.nc',90)
n250_day180<-load_netcdf('n250_day180.nc',180)


#load n500 with diff days
n500_day30<-load_netcdf('n500_day30.nc',30)
n500_day60<-load_netcdf('n500_day60.nc',60)
n500_day90<-load_netcdf('n500_day90.nc',90)
n500_day180<-load_netcdf('n500_day180.nc',180)

#load n750 with diff days, the reason this set is divided into thirds is because the model crashes when running the entire thing so this number of particles was run with the release sites divided up into thirds and then merged after for stats and comparisons
n750_1_day30<-load_netcdf('n750_day30_first.nc',30)
n750_1_day60<-load_netcdf('n750_day60_first.nc',60)
n750_1_day90<-load_netcdf('n750_day90_first.nc',90)
n750_1_day180<-load_netcdf('n750_day180_first.nc',180)

n750_2_day30<-load_netcdf('n750_day30_second.nc',30)
n750_2_day60<-load_netcdf('n750_day60_second.nc',60)
n750_2_day90<-load_netcdf('n750_day90_second.nc',90)
n750_2_day180<-load_netcdf('n750_day180_second.nc',180)

n750_3_day30<-load_netcdf('n750_day30_third.nc',30)
n750_3_day60<-load_netcdf('n750_day60_third.nc',60)
n750_3_day90<-load_netcdf('n750_day90_third.nc',90)
n750_3_day180<-load_netcdf('n750_day180_third.nc',180)

# bind these together
n750_day30<-rbind(n750_1_day30,n750_2_day30,n750_3_day30)
rm(n750_1_day30) # running this code is memory intensive so it is good to remove unnecessary things
rm(n750_2_day30)
rm(n750_3_day30)

n750_day60<-rbind(n750_1_day60,n750_2_day60,n750_3_day60)
rm(n750_1_day60)
rm(n750_2_day60)
rm(n750_3_day60)

n750_day90<-rbind(n750_1_day90,n750_2_day90,n750_3_day90)
rm(n750_1_day90)
rm(n750_2_day90)
rm(n750_3_day90)

n750_day180<-rbind(n750_1_day180,n750_2_day180,n750_3_day180)
rm(n750_1_day180)
rm(n750_2_day180)
rm(n750_3_day180)


#load n1000 with diff days, the reason this set is divided into thirds is because the model crashes when running the entire thing so this number of particles was run with the release sites divided up into thirds and then merged after for stats and comparisons
n1000_1_day30<-load_netcdf('n1000_1_day30.nc',30)
n1000_1_day60<-load_netcdf('n1000_1_day60.nc',60)
n1000_1_day90<-load_netcdf('n1000_1_day90.nc',90)
n1000_1_day180<-load_netcdf('n1000_1_day180.nc',180)

n1000_2_day30<-load_netcdf('n1000_2_day30.nc',30)
n1000_2_day60<-load_netcdf('n1000_2_day60.nc',60)
n1000_2_day90<-load_netcdf('n1000_2_day90.nc',90)
n1000_2_day180<-load_netcdf('n1000_2_day180.nc',180)

n1000_3_day30<-load_netcdf('n1000_3_day30.nc',30)
n1000_3_day60<-load_netcdf('n1000_3_day60.nc',60)
n1000_3_day90<-load_netcdf('n1000_3_day90.nc',90)
n1000_3_day180<-load_netcdf('n1000_3_day180.nc',180)

# bind these together
n1000_day30<-rbind(n1000_1_day30,n1000_2_day30,n1000_3_day30)
rm(n1000_1_day30) # running this code is memory intensive so it is good to remove unnecessary things
rm(n1000_2_day30)
rm(n1000_3_day30)

n1000_day60<-rbind(n1000_1_day60,n1000_2_day60,n1000_3_day60)
rm(n1000_1_day60)
rm(n1000_2_day60)
rm(n1000_3_day60)

n1000_day90<-rbind(n1000_1_day90,n1000_2_day90,n1000_3_day90)
rm(n1000_1_day90)
rm(n1000_2_day90)
rm(n1000_3_day90)

n1000_day180<-rbind(n1000_1_day180,n1000_2_day180,n1000_3_day180)
rm(n1000_1_day180)
rm(n1000_2_day180)
rm(n1000_3_day180)

```


# Calculate the PDDs using the MASS package
```{r}
# Create a function to calculate PDDs
densitydist<-function(input,xboxes,yboxes){
  dd <- kde2d(input$lon, input$lat, n=c(xboxes,yboxes),lims=c(120,240,0,50)) 
  str(dd)
  dd_df <<-data.frame(expand.grid(dd$x, dd$y), density=as.vector(dd$z))
}

#100 particles
dd30_n100<-densitydist(n100_day30,350,150)
names(dd30_n100)[1:2] <- c('lon', 'lat') # this just renames the file
rm(n100_day30) # remove unneccesary things
write.csv(dd30_n100,file="dd30_n100.csv")# write this to a file because sometimes this R file runs out of memory so to account fo this you can wipe the memory after running each of these files and the load back in the PDD files later for calculating the FUV. For other sensitivity tests this wasn't necessary but for this one it was. 
rm(dd30_n100)

dd60_n100<-densitydist(n100_day60,350,150)
names(dd60_n100)[1:2] <- c('lon', 'lat')
rm(n100_day60)
write.csv(dd60_n100,file="dd60_n100.csv")
rm(dd60_n100)

dd90_n100<-densitydist(n100_day90,350,150)
names(dd90_n100)[1:2] <- c('lon', 'lat')
rm(n100_day90)
write.csv(dd90_n100,file="dd90_n100.csv")
rm(dd90_n100)

dd180_n100<-densitydist(n100_day180,350,150)
names(dd180_n100)[1:2] <- c('lon', 'lat')
rm(n100_day180)
write.csv(dd180_n100,file="dd180_n100.csv")
rm(dd180_n100)

#100 particles repeat
dd30_n100_repeat<-densitydist(n100_repeat_day30,350,150)
names(dd30_n100_repeat)[1:2] <- c('lon', 'lat')
rm(n100_repeat_day30)
write.csv(dd30_n100_repeat,file="dd30_n100_repeat.csv")
rm(dd30_n100_repeat)

dd60_n100_repeat<-densitydist(n100_repeat_day60,350,150)
names(dd60_n100_repeat)[1:2] <- c('lon', 'lat')
rm(n100_repeat_day60)
write.csv(dd60_n100_repeat,file="dd60_n100_repeat.csv")
rm(dd60_n100_repeat)

dd90_n100_repeat<-densitydist(n100_repeat_day90,350,150)
names(dd90_n100_repeat)[1:2] <- c('lon', 'lat')
rm(n100_repeat_day90)
write.csv(dd90_n100_repeat,file="dd90_n100_repeat.csv")
rm(dd90_n100_repeat)

dd180_n100_repeat<-densitydist(n100_repeat_day180,350,150)
names(dd180_n100_repeat)[1:2] <- c('lon', 'lat')
rm(n100_repeat_day180)
write.csv(dd180_n100_repeat,file="dd180_n100_repeat.csv")
rm(dd180_n100_repeat)

#250 particles
dd30_n250<-densitydist(n250_day30,350,150)
names(dd30_n250)[1:2] <- c('lon', 'lat')
rm(n250_day30)
write.csv(dd30_n250,file="dd30_n250.csv")
rm(dd30_n250)

dd60_n250<-densitydist(n250_day60,350,150)
names(dd60_n250)[1:2] <- c('lon', 'lat')
rm(n250_day60)
write.csv(dd60_n250,file="dd60_n250.csv")
rm(dd60_n250)

dd90_n250<-densitydist(n250_day90,350,150)
names(dd90_n250)[1:2] <- c('lon', 'lat')
rm(n250_day90)
write.csv(dd90_n250,file="dd90_n250.csv")
rm(dd90_n250)

dd180_n250<-densitydist(n250_day180,350,150)
names(dd180_n250)[1:2] <- c('lon', 'lat')
rm(n250_day180)
write.csv(dd180_n250,file="dd180_n250.csv")
rm(dd180_n250)

#500 particles
dd30_n500<-densitydist(n500_day30,350,150)
names(dd30_n500)[1:2] <- c('lon', 'lat')
rm(n500_day30)
write.csv(dd30_n500,file="dd30_n500.csv")
rm(dd30_n500)

dd60_n500<-densitydist(n500_day60,350,150)
names(dd60_n500)[1:2] <- c('lon', 'lat')
rm(n500_day60)
write.csv(dd60_n500,file="dd60_n500.csv")
rm(dd60_n500)

dd90_n500<-densitydist(n500_day90,350,150)
names(dd90_n500)[1:2] <- c('lon', 'lat')
rm(n500_day90)
write.csv(dd90_n500,file="dd90_n500.csv")
rm(dd90_n500)

dd180_n500<-densitydist(n500_day180,350,150)
names(dd180_n500)[1:2] <- c('lon', 'lat')
rm(n500_day180)
write.csv(dd180_n500,file="dd180_n500.csv")
rm(dd180_n500)

#750 particles
dd <- kde2d(n750_day30$lon, n750_day30$lat, n=c(350,150),lims=c(120,240,0,50))
dd30_n750<-densitydist(n750_day30,350,150)
names(dd30_n750)[1:2] <- c('lon', 'lat')
rm(n750_day30)
write.csv(dd30_n750,file="dd30_n750.csv")
rm(dd30_n750)

rm(output)
dd60_n750<-densitydist(n750_day60,350,150)
names(dd60_n750)[1:2] <- c('lon', 'lat')
rm(n750_day60)
write.csv(dd60_n750,file="dd60_n750.csv")
rm(dd60_n750)

dd90_n750<-densitydist(n750_day90,350,150)
names(dd90_n750)[1:2] <- c('lon', 'lat')
rm(n750_day90)
write.csv(dd90_n750,file="dd90_n750.csv")
rm(dd90_n750)

dd180_n750<-densitydist(n750_day180,350,150)
names(dd180_n750)[1:2] <- c('lon', 'lat')
rm(n750_day180)
write.csv(dd180_n750,file="dd180_n750.csv")
rm(dd180_n750)

#1000 particles
dd30_n1000<-densitydist(n1000_day30,350,150)
names(dd30_n1000)[1:2] <- c('lon', 'lat')
rm(n1000_day30)
write.csv(dd30_n1000,file="dd30_n1000.csv")
rm(dd30_n1000)

dd60_n1000<-densitydist(n1000_day60,350,150)
names(dd60_n1000)[1:2] <- c('lon', 'lat')
rm(n1000_day60)
write.csv(dd60_n1000,file="dd60_n1000.csv")
rm(dd60_n1000)

dd90_n1000<-densitydist(n1000_day90,350,150)
names(dd90_n1000)[1:2] <- c('lon', 'lat')
rm(n1000_day90)
write.csv(dd90_n1000,file="dd90_n1000.csv")
rm(dd90_n1000)

dd180_n1000<-densitydist(n1000_day180,350,150)
names(dd180_n1000)[1:2] <- c('lon', 'lat')
rm(n1000_day180)
write.csv(dd180_n1000,file="dd180_n1000.csv")
rm(dd180_n1000)

```

# Calculate the FUV by 1-R^2
```{r}
# Load the files back in (because the previous steps needed the full amount of memory)
#between 100 and 100 repeat
dd30_n100<-read.csv("dd30_n100.csv", stringsAsFactors = F,header = TRUE)
dd30_n100<-dd30_n100[2:4]
dd60_n100<-read.csv("dd60_n100.csv",stringsAsFactors = F,header = TRUE)
dd60_n100<-dd60_n100[2:4]
dd90_n100<-read.csv("dd90_n100.csv", stringsAsFactors = F,header = TRUE)
dd90_n100<-dd90_n100[2:4]
dd180_n100<-read.csv("dd180_n100.csv",stringsAsFactors = F,header = TRUE)
dd180_n100<-dd180_n100[2:4]

dd30_n100_repeat<-read.csv("dd30_n100_repeat.csv", stringsAsFactors = F,header = TRUE)
dd30_n100_repeat<-dd30_n100_repeat[2:4]
dd60_n100_repeat<-read.csv("dd60_n100_repeat.csv",stringsAsFactors = F,header = TRUE)
dd60_n100_repeat<-dd60_n100_repeat[2:4]
dd90_n100_repeat<-read.csv("dd90_n100_repeat.csv", stringsAsFactors = F,header = TRUE)
dd90_n100_repeat<-dd90_n100_repeat[2:4]
dd180_n100_repeat<-read.csv("dd180_n100_repeat.csv",stringsAsFactors = F,header = TRUE)
dd180_n100_repeat<-dd180_n100_repeat[2:4]

dd30_n250<-read.csv("dd30_n250.csv", stringsAsFactors = F,header = TRUE)
dd30_n250<-dd30_n250[2:4]
dd60_n250<-read.csv("dd60_n250.csv",stringsAsFactors = F,header = TRUE)
dd60_n250<-dd60_n250[2:4]
dd90_n250<-read.csv("dd90_n250.csv", stringsAsFactors = F,header = TRUE)
dd90_n250<-dd90_n250[2:4]
dd180_n250<-read.csv("dd180_n250.csv",stringsAsFactors = F,header = TRUE)
dd180_n250<-dd180_n250[2:4]

dd30_n500<-read.csv("dd30_n500.csv", stringsAsFactors = F,header = TRUE)
dd30_n500<-dd30_n500[2:4]
dd60_n500<-read.csv("dd60_n500.csv",stringsAsFactors = F,header = TRUE)
dd60_n500<-dd60_n500[2:4]
dd90_n500<-read.csv("dd90_n500.csv", stringsAsFactors = F,header = TRUE)
dd90_n500<-dd90_n500[2:4]
dd180_n500<-read.csv("dd180_n500.csv",stringsAsFactors = F,header = TRUE)
dd180_n500<-dd180_n500[2:4]

dd30_n750<-read.csv("dd30_n750.csv", stringsAsFactors = F,header = TRUE)
dd30_n750<-dd30_n750[2:4]
dd60_n750<-read.csv("dd60_n750.csv",stringsAsFactors = F,header = TRUE)
dd60_n750<-dd60_n750[2:4]
dd90_n750<-read.csv("dd90_n750.csv", stringsAsFactors = F,header = TRUE)
dd90_n750<-dd90_n750[2:4]
dd180_n750<-read.csv("dd180_n750.csv",stringsAsFactors = F,header = TRUE)
dd180_n750<-dd180_n750[2:4]

dd30_n1000<-read.csv("dd30_n1000.csv", stringsAsFactors = F,header = TRUE)
dd30_n1000<-dd30_n1000[2:4]
dd60_n1000<-read.csv("dd60_n1000.csv",stringsAsFactors = F,header = TRUE)
dd60_n1000<-dd60_n1000[2:4]
dd90_n1000<-read.csv("dd90_n1000.csv", stringsAsFactors = F,header = TRUE)
dd90_n1000<-dd90_n1000[2:4]
dd180_n1000<-read.csv("dd180_n1000.csv",stringsAsFactors = F,header = TRUE)
dd180_n1000<-dd180_n1000[2:4]
##########################################################################

# Calculate FUV by 1-R^2
#100 and ...
#between 100 and 100 repeated
fuv_100repeats_d30<-1-(cor(dd30_n100$density, dd30_n100_repeat$density, method='pearson')^2)
fuv_100repeats_d60<-1-(cor(dd60_n100$density, dd60_n100_repeat$density, method='pearson')^2)
fuv_100repeats_d90<-1-(cor(dd90_n100$density, dd90_n100_repeat$density, method='pearson')^2)
fuv_100repeats_d180<-1-(cor(dd180_n100$density, dd180_n100_repeat$density, method='pearson')^2)

#between 250 and 100
fuv_100250_d30<-1-(cor(dd30_n100$density, dd30_n250$density, method='pearson')^2)
fuv_100250_d60<-1-(cor(dd60_n100$density, dd60_n250$density, method='pearson')^2)
fuv_100250_d90<-1-(cor(dd90_n100$density, dd90_n250$density, method='pearson')^2)
fuv_100250_d180<-1-(cor(dd180_n100$density, dd180_n250$density, method='pearson')^2)

#between 500 and 100
fuv_100500_d30<-1-(cor(dd30_n100$density, dd30_n500$density, method='pearson')^2)
fuv_100500_d60<-1-(cor(dd60_n100$density, dd60_n500$density, method='pearson')^2)
fuv_100500_d90<-1-(cor(dd90_n100$density, dd90_n500$density, method='pearson')^2)
fuv_100500_d180<-1-(cor(dd180_n100$density, dd180_n500$density, method='pearson')^2)

#between 750 and 100
fuv_100750_d30<-1-(cor(dd30_n100$density, dd30_n750$density, method='pearson')^2)
fuv_100750_d60<-1-(cor(dd60_n100$density, dd60_n750$density, method='pearson')^2)
fuv_100750_d90<-1-(cor(dd90_n100$density, dd90_n750$density, method='pearson')^2)
fuv_100750_d180<-1-(cor(dd180_n100$density, dd180_n750$density, method='pearson')^2)

#between 100 and 1000
fuv_1001000_d30<-1-(cor(dd30_n100$density, dd30_n1000$density, method='pearson')^2)
fuv_1001000_d60<-1-(cor(dd60_n100$density, dd60_n1000$density, method='pearson')^2)
fuv_1001000_d90<-1-(cor(dd90_n100$density, dd90_n1000$density, method='pearson')^2)
fuv_1001000_d180<-1-(cor(dd180_n100$density, dd180_n1000$density, method='pearson')^2)

#100 repeat and ...
#between 500 and 100 repeat
fuv_100repeat500_d30<-1-(cor(dd30_n100_repeat$density, dd30_n500$density, method='pearson')^2)
fuv_100repeat500_d60<-1-(cor(dd60_n100_repeat$density, dd60_n500$density, method='pearson')^2)
fuv_100repeat500_d90<-1-(cor(dd90_n100_repeat$density, dd90_n500$density, method='pearson')^2)
fuv_100repeat500_d180<-1-(cor(dd180_n100_repeat$density, dd180_n500$density, method='pearson')^2)

fuv_100repeat250_d30<-1-(cor(dd30_n100_repeat$density, dd30_n250$density, method='pearson')^2)
fuv_100repeat250_d60<-1-(cor(dd60_n100_repeat$density, dd60_n250$density, method='pearson')^2)
fuv_100repeat250_d90<-1-(cor(dd90_n100_repeat$density, dd90_n250$density, method='pearson')^2)
fuv_100repeat250_d180<-1-(cor(dd180_n100_repeat$density, dd180_n250$density, method='pearson')^2)

fuv_100repeat750_d30<-1-(cor(dd30_n100_repeat$density, dd30_n750$density, method='pearson')^2)
fuv_100repeat750_d60<-1-(cor(dd60_n100_repeat$density, dd60_n750$density, method='pearson')^2)
fuv_100repeat750_d90<-1-(cor(dd90_n100_repeat$density, dd90_n750$density, method='pearson')^2)
fuv_100repeat750_d180<-1-(cor(dd180_n100_repeat$density, dd180_n750$density, method='pearson')^2)

fuv_1001000_d30_repeat<-1-(cor(dd30_n100_repeat$density, dd30_n1000$density, method='pearson')^2)
fuv_1001000_d60_repeat<-1-(cor(dd60_n100_repeat$density, dd60_n1000$density, method='pearson')^2)
fuv_1001000_d90_repeat<-1-(cor(dd90_n100_repeat$density, dd90_n1000$density, method='pearson')^2)
fuv_1001000_d180_repeat<-1-(cor(dd180_n100_repeat$density, dd180_n1000$density, method='pearson')^2)


#250 and ...
#between 500 and 250
fuv_250500_d30<-1-(cor(dd30_n250$density, dd30_n500$density, method='pearson')^2)
fuv_250500_d60<-1-(cor(dd60_n250$density, dd60_n500$density, method='pearson')^2)
fuv_250500_d90<-1-(cor(dd90_n250$density, dd90_n500$density, method='pearson')^2)
fuv_250500_d180<-1-(cor(dd180_n250$density, dd180_n500$density, method='pearson')^2)

#between 750 and 250
fuv_250750_d30<-1-(cor(dd30_n250$density, dd30_n750$density, method='pearson')^2)
fuv_250750_d60<-1-(cor(dd60_n250$density, dd60_n750$density, method='pearson')^2)
fuv_250750_d90<-1-(cor(dd90_n250$density, dd90_n750$density, method='pearson')^2)
fuv_250750_d180<-1-(cor(dd180_n250$density, dd180_n750$density, method='pearson')^2)

#between 1000 and 250
fuv_2501000_d30<-1-(cor(dd30_n250$density, dd30_n1000$density, method='pearson')^2)
fuv_2501000_d60<-1-(cor(dd60_n250$density,dd60_n1000$density, method='pearson')^2)
fuv_2501000_d90<-1-(cor(dd90_n250$density, dd90_n1000$density, method='pearson')^2)
fuv_2501000_d180<-1-(cor(dd180_n250$density, dd180_n1000$density, method='pearson')^2)


#500 and ...
#between 750 and 250
fuv_500750_d30<-1-(cor(dd30_n500$density, dd30_n750$density, method='pearson')^2)
fuv_500750_d60<-1-(cor(dd60_n500$density, dd60_n750$density, method='pearson')^2)
fuv_500750_d90<-1-(cor(dd90_n500$density, dd90_n750$density, method='pearson')^2)
fuv_500750_d180<-1-(cor(dd180_n500$density, dd180_n750$density, method='pearson')^2)

#between 500 and 1000
fuv_5001000_d30<-1-(cor(dd30_n500$density, dd30_n1000$density, method='pearson')^2)
fuv_5001000_d60<-1-(cor(dd60_n500$density,dd60_n1000$density, method='pearson')^2)
fuv_5001000_d90<-1-(cor(dd90_n500$density, dd90_n1000$density, method='pearson')^2)
fuv_5001000_d180<-1-(cor(dd180_n500$density, dd180_n1000$density, method='pearson')^2)

#between 750 and 1000
fuv_7501000_d30<-1-(cor(dd30_n750$density, dd30_n1000$density, method='pearson')^2)
fuv_7501000_d60<-1-(cor(dd60_n750$density,dd60_n1000$density, method='pearson')^2)
fuv_7501000_d90<-1-(cor(dd90_n750$density, dd90_n1000$density, method='pearson')^2)
fuv_7501000_d180<-1-(cor(dd180_n750$density, dd180_n1000$density, method='pearson')^2)
####################################################################################

# Make table
sumresults<-data.frame(matrix(ncol=0,nrow=15))
sumresults$x<-c("100","100","100","100","100","100repeat","100repeat","100repeat","100repeat","250","250","250","500","500","750")
sumresults$y<-c("100repeat","250","500","750","1000","250","500","750","1000","500","750","1000","750","1000","1000")
sumresults$day30<-c(fuv_100repeats_d30,fuv_100250_d30,fuv_100500_d30,fuv_100750_d30,fuv_1001000_d30,fuv_100repeat250_d30,fuv_100repeat500_d30,fuv_100repeat750_d30,fuv_1001000_d30_repeat,fuv_250500_d30,fuv_250750_d30,fuv_2501000_d30,fuv_500750_d30,fuv_5001000_d30,fuv_7501000_d30)
sumresults$day60<-c(fuv_100repeats_d60,fuv_100250_d60,fuv_100500_d60,fuv_100750_d60,fuv_1001000_d60,fuv_100repeat250_d60,fuv_100repeat500_d60,fuv_100repeat750_d60,fuv_1001000_d60_repeat,fuv_250500_d60,fuv_250750_d60,fuv_2501000_d60,fuv_500750_d60,fuv_5001000_d60,fuv_7501000_d60)
sumresults$day90<-c(fuv_100repeats_d90,fuv_100250_d90,fuv_100500_d90,fuv_100750_d90,fuv_1001000_d90,fuv_100repeat250_d90,fuv_100repeat500_d90,fuv_100repeat750_d90,fuv_1001000_d90_repeat,fuv_250500_d90,fuv_250750_d90,fuv_2501000_d90,fuv_500750_d90,fuv_5001000_d90,fuv_7501000_d90)
sumresults$day180<-c(fuv_100repeats_d180,fuv_100250_d180,fuv_100500_d180,fuv_100750_d180,fuv_1001000_d180,fuv_100repeat250_d180,fuv_100repeat500_d180,fuv_100repeat750_d180,fuv_1001000_d180_repeat,fuv_250500_d180,fuv_250750_d180,fuv_2501000_d180,fuv_500750_d180,fuv_5001000_d180,fuv_7501000_d180)
write.csv(sumresults,"fuv_comparisons_results_finerscale.csv")
```



